
<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Add Seat Layout - BookMyTicket Admin</title>

	<!-- Bootstrap -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

	<!-- Google Font -->
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">

	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}

		body {
			font-family: "Poppins", sans-serif;
			background: linear-gradient(135deg, #f0f4f8 0%, #e8f0f7 50%, #f0f4f8 100%);
			min-height: 100vh;
			padding: 40px 20px;
			color: #1a2332;
		}

		/* Main Container */
		.container-wrapper {
			max-width: 900px;
			margin: 0 auto;
		}

		/* Header */
		.page-header {
			text-align: center;
			margin-bottom: 50px;
		}

		.page-header h1 {
			font-weight: 700;
			color: #1a2332;
			font-size: 2.2rem;
			margin-bottom: 10px;
		}

		.page-header p {
			color: #5a6b7d;
			font-size: 1rem;
		}

		/* Content Box */
		.content-box {
			background: linear-gradient(135deg, rgba(100, 150, 255, 0.08) 0%, rgba(255, 64, 129, 0.04) 100%);
			border-radius: 20px;
			border: 1.5px solid rgba(100, 150, 255, 0.2);
			padding: 50px;
			box-shadow: 0 20px 50px rgba(100, 150, 255, 0.1);
			animation: fadeInUp 0.8s ease-out;
		}

		/* Layout Container */
		.layout-container {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 40px;
			align-items: start;
		}

		.form-section {
			display: flex;
			flex-direction: column;
			gap: 25px;
		}

		.preview-section {
			display: flex;
			flex-direction: column;
			gap: 20px;
		}

		.section-title {
			font-weight: 700;
			color: #1a2332;
			font-size: 1.3rem;
			margin-bottom: 20px;
			padding-bottom: 15px;
			border-bottom: 2px solid rgba(100, 150, 255, 0.2);
		}

		/* Instructions */
		.instructions {
			background: rgba(100, 150, 255, 0.1);
			border-left: 4px solid #6496ff;
			padding: 20px;
			border-radius: 10px;
			margin-bottom: 30px;
		}

		.instructions ol {
			margin-bottom: 0;
			padding-left: 20px;
		}

		.instructions li {
			color: #5a6b7d;
			margin-bottom: 8px;
			font-weight: 500;
		}

		/* Form Group */
		.form-group {
			margin-bottom: 25px;
		}

		label {
			display: block;
			margin-bottom: 8px;
			font-weight: 600;
			color: #1a2332;
			font-size: 0.95rem;
		}

		.form-control {
			background: rgba(255, 255, 255, 0.7);
			border: 1.5px solid rgba(100, 150, 255, 0.15);
			border-radius: 10px;
			padding: 12px 16px;
			font-size: 0.95rem;
			color: #1a2332;
			font-weight: 500;
			transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
			font-family: "Poppins", sans-serif;
			width: 100%;
		}

		.form-control:focus {
			background: rgba(255, 255, 255, 0.85);
			border-color: #6496ff;
			box-shadow: 0 0 0 3px rgba(100, 150, 255, 0.15);
			color: #1a2332;
			outline: none;
		}

		/* Button Group */
		.button-group {
			display: flex;
			gap: 15px;
			justify-content: center;
			margin-top: 40px;
		}

		.btn-primary-custom {
			background: linear-gradient(135deg, #6496ff 0%, #ff4081 100%);
			color: white !important;
			border: none;
			padding: 12px 32px;
			border-radius: 10px;
			font-weight: 600;
			font-size: 0.95rem;
			cursor: pointer;
			transition: all 0.3s ease;
			text-decoration: none;
		}

		.btn-primary-custom:hover {
			transform: translateY(-2px);
			box-shadow: 0 4px 15px rgba(100, 150, 255, 0.25);
		}

		.btn-primary-custom:disabled {
			opacity: 0.5;
			cursor: not-allowed;
			transform: none;
		}

		.btn-secondary-custom {
			background: rgba(100, 150, 255, 0.15);
			color: #6496ff;
			border: 1.5px solid rgba(100, 150, 255, 0.3);
			padding: 12px 32px;
			border-radius: 10px;
			font-weight: 600;
			font-size: 0.95rem;
			cursor: pointer;
			transition: all 0.3s ease;
			text-decoration: none;
		}

		.btn-secondary-custom:hover {
			background: rgba(100, 150, 255, 0.25);
			border-color: rgba(100, 150, 255, 0.5);
		}

		/* Section Form */
		.section-form {
			background: rgba(100, 150, 255, 0.05);
			border: 1px solid rgba(100, 150, 255, 0.15);
			padding: 25px;
			border-radius: 12px;
			margin-bottom: 30px;
		}

		/* Layout Preview */
		.layout-preview {
			background: rgba(100, 150, 255, 0.05);
			border: 2px dashed rgba(100, 150, 255, 0.2);
			border-radius: 12px;
			padding: 30px 20px;
			min-height: 400px;
			display: flex;
			flex-direction: column;
			gap: 15px;
			animation: fadeInUp 0.5s ease-out;
			overflow-y: auto;
			max-height: 600px;
		}

		.preview-empty {
			color: #5a6b7d;
			text-align: center;
			font-style: italic;
			margin: auto;
		}

		/* All Rows Container */
		.all-rows-layout {
			display: flex;
			flex-direction: column;
			gap: 12px;
			width: 100%;
		}

		/* Row Layout */
		.row-layout {
			display: flex;
			align-items: center;
			gap: 15px;
		}

		.row-name-label {
			min-width: 45px;
			font-weight: 700;
			color: #6496ff;
			font-size: 1.1rem;
			text-align: center;
			padding: 8px 12px;
			background: rgba(100, 150, 255, 0.15);
			border-radius: 8px;
			border: 1.5px solid rgba(100, 150, 255, 0.2);
		}

		.row-seats {
			display: flex;
			gap: 6px;
			flex-wrap: wrap;
		}

		.seat {
			width: 32px;
			height: 32px;
			border-radius: 6px;
			border: 2px solid rgba(100, 150, 255, 0.3);
			background: rgba(100, 150, 255, 0.15);
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 0.75rem;
			font-weight: 600;
			color: #6496ff;
			transition: all 0.2s ease;
		}

		.seat:hover {
			background: rgba(100, 150, 255, 0.25);
			border-color: rgba(100, 150, 255, 0.5);
		}

		@keyframes slideDown {
			from {
				opacity: 0;
				transform: translateY(-10px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		/* Responsive */
		@media (max-width: 1200px) {
			.layout-container {
				grid-template-columns: 1fr;
				gap: 30px;
			}

			.layout-preview {
				min-height: 300px;
				max-height: 400px;
			}
		}

		@media (max-width: 768px) {
			.container-wrapper {
				padding: 0 15px;
			}

			.content-box {
				padding: 30px;
			}

			.page-header h1 {
				font-size: 1.5rem;
			}

			.page-header p {
				font-size: 0.9rem;
			}

			.section-title {
				font-size: 1.1rem;
				margin-bottom: 15px;
			}

			.form-group {
				margin-bottom: 20px;
			}

			label {
				font-size: 0.9rem;
			}

			.form-control, select {
				padding: 10px 14px;
				font-size: 0.9rem;
			}

			.seat {
				width: 28px;
				height: 28px;
				font-size: 0.65rem;
			}

			.row-name-label {
				min-width: 40px;
				font-size: 0.95rem;
			}
		}

		@media (max-width: 480px) {
			body {
				padding: 20px 10px;
			}

			.content-box {
				padding: 25px;
			}

			.page-header h1 {
				font-size: 1.3rem;
				margin-bottom: 8px;
			}

			.page-header p {
				font-size: 0.85rem;
			}

			.section-title {
				font-size: 1rem;
			}

			.form-group {
				margin-bottom: 18px;
			}

			label {
				font-size: 0.85rem;
			}

			.form-control, select {
				padding: 10px 12px;
				font-size: 0.85rem;
			}

			.button-group {
				gap: 10px;
				margin-top: 30px;
				flex-direction: column;
			}

			.btn-primary-custom, .btn-secondary-custom {
				padding: 10px 20px;
				font-size: 0.85rem;
				width: 100%;
			}

			.seat {
				width: 24px;
				height: 24px;
				font-size: 0.6rem;
			}

			.row-name-label {
				min-width: 35px;
				font-size: 0.85rem;
				padding: 6px 10px;
			}

			.row-seats {
				gap: 4px;
			}
		}

		/* Animations */
		@keyframes fadeInUp {
			from {
				opacity: 0;
				transform: translateY(30px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		/* Responsive Design */
		@media (max-width: 992px) {
			.content-box {
				padding: 40px;
			}

			.page-header h1 {
				font-size: 1.8rem;
			}

			.button-group {
				flex-direction: column;
			}

			.btn-primary-custom, .btn-secondary-custom {
				width: 100%;
			}
		}

		@media (max-width: 768px) {
			.container-wrapper {
				padding: 0 15px;
			}

			.content-box {
				padding: 30px;
			}

			.page-header h1 {
				font-size: 1.5rem;
			}

			.page-header p {
				font-size: 0.9rem;
			}

			.section-title {
				font-size: 1.1rem;
				margin-bottom: 15px;
			}

			.form-group {
				margin-bottom: 20px;
			}

			label {
				font-size: 0.9rem;
			}

			.form-control {
				padding: 10px 14px;
				font-size: 0.9rem;
			}
		}

		@media (max-width: 480px) {
			body {
				padding: 20px 10px;
			}

			.content-box {
				padding: 25px;
			}

			.page-header h1 {
				font-size: 1.3rem;
				margin-bottom: 8px;
			}

			.page-header p {
				font-size: 0.85rem;
			}

			.section-title {
				font-size: 1rem;
			}

			.form-group {
				margin-bottom: 18px;
			}

			label {
				font-size: 0.85rem;
			}

			.form-control {
				padding: 10px 12px;
				font-size: 0.85rem;
			}

			.button-group {
				gap: 10px;
				margin-top: 30px;
			}

			.btn-primary-custom, .btn-secondary-custom {
				padding: 10px 20px;
				font-size: 0.85rem;
			}
		}
	</style>
</head>

<body>

	<!-- CONTAINER -->
	<div class="container-wrapper">

		<!-- HEADER -->
		<div class="page-header">
			<h1>ü™ë Create Seat Layout</h1>
			<p>Design the seating arrangement for your screen</p>
		</div>

		<!-- CONTENT BOX -->
		<div class="content-box">

			<div class="section-title">üìã Instructions</div>
			<div class="instructions">
				<ol>
					<li>Define the number of rows and seats per row</li>
					<li>Click "Create Layout" to generate the seat map</li>
					<li>Configure individual seat properties if needed</li>
					<li>Save the layout to apply it to this screen</li>
				</ol>
			</div>

			<form id="seatLayoutForm" method="POST" action="/save-seats">

				<div class="section-title">‚öôÔ∏è Seat Configuration</div>

				<!-- ROW CONFIGURATION -->
				<div class="section-form">
					<div class="form-group">
						<label for="rowName">Row Name/Label</label>
						<input type="text" id="rowName" class="form-control" placeholder="e.g., A, B, C, VIP, Premium">
					</div>

					<div class="form-group">
						<label for="columns">Number of Seats</label>
						<input type="number" id="columns" class="form-control" placeholder="e.g., 10" min="1" max="50">
					</div>

					<div class="form-group">
						<label for="category">Seat Category</label>
						<select id="category" class="form-control">
							<option value="">-- Select Category --</option>
							<option value="standard">Standard</option>
							<option value="premium">Premium</option>
							<option value="vip">VIP</option>
							<option value="handicap">Handicap Access</option>
						</select>
					</div>

					<button type="button" id="addRowBtn" class="btn-primary-custom">+ Add Row</button>
				</div>

				<!-- PREVIEW SECTION -->
				<div class="section-title" style="margin-top: 40px;">üëÅÔ∏è Preview Seat Layout</div>

				<div id="layoutPreview" class="layout-preview">
					<p class="preview-empty">Rows will appear here as you add them</p>
				</div>

				<!-- ACTION BUTTONS -->
				<div class="button-group">
					<a href="/manage-theaters" class="btn-secondary-custom">‚Üê Cancel</a>
					<button type="submit" id="saveLayoutBtn" class="btn-primary-custom" disabled>‚úì Save Seat Layout</button>
				</div>

			</form>

		</div>

	</div>

	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

	<script>
		// Store seat layout data
		let seatLayout = [];

		// Get DOM elements
		const rowNameInput = document.getElementById('rowName');
		const columnsInput = document.getElementById('columns');
		const categorySelect = document.getElementById('category');
		const addRowBtn = document.getElementById('addRowBtn');
		const layoutPreview = document.getElementById('layoutPreview');
		const saveLayoutBtn = document.getElementById('saveLayoutBtn');

		// Add row button click handler
		addRowBtn.addEventListener('click', () => {
			const rowName = rowNameInput.value.trim();
			const columns = parseInt(columnsInput.value);
			const category = categorySelect.value;

			// Validation
			if (!rowName) {
				alert('Please enter a row name/label');
				rowNameInput.focus();
				return;
			}

			if (!columns || columns < 1 || columns > 50) {
				alert('Please enter a valid number of seats (1-50)');
				columnsInput.focus();
				return;
			}

			if (!category) {
				alert('Please select a seat category');
				categorySelect.focus();
				return;
			}

			// Check for duplicate row names
			if (seatLayout.some(row => row.name === rowName)) {
				alert('Row name already exists. Please use a different name.');
				rowNameInput.focus();
				return;
			}

			// Add row to data
			const newRow = {
				id: Date.now(),
				name: rowName,
				columns: columns,
				category: category
			};

			seatLayout.push(newRow);

			// Update preview
			updatePreview();

			// Clear inputs
			rowNameInput.value = '';
			columnsInput.value = '';
			categorySelect.value = '';
			rowNameInput.focus();

			// Enable save button
			saveLayoutBtn.disabled = false;
		});

		// Update preview function
		function updatePreview() {
			if (seatLayout.length === 0) {
				layoutPreview.innerHTML = '<p class="preview-empty">Rows will appear here as you add them</p>';
				return;
			}

			layoutPreview.innerHTML = `
				<div style="text-align: center; margin-bottom: 30px;">
					<div style="background: linear-gradient(135deg, #6496ff 0%, #ff4081 100%); color: white; padding: 15px 30px; border-radius: 10px; font-weight: 600; font-size: 1.1rem; letter-spacing: 2px;">
						üé¨ SCREEN THIS SIDE üé¨
					</div>
				</div>
				<div class="all-rows-layout">
					${seatLayout.map(row => {
						const seats = Array.from({ length: row.columns }, (_, i) => {
							return `<div class="seat">${row.name}${i + 1}</div>`;
						}).join('');

						return `
							<div class="row-layout">
								<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; gap: 15px;">
									<div class="row-name-label">${row.name}</div>
									<button class="row-delete-btn" onclick="deleteRow(${row.id})">üóëÔ∏è Delete</button>
								</div>
								<div class="row-seats">
									${seats}
								</div>
							</div>
						`;
					}).join('')}
				</div>
			`;
		}

		// Delete row function
		window.deleteRow = function(rowId) {
			seatLayout = seatLayout.filter(row => row.id !== rowId);
			updatePreview();

			if (seatLayout.length === 0) {
				saveLayoutBtn.disabled = true;
			}
		};

		// Get form element
		const seatLayoutForm = document.getElementById('seatLayoutForm');

		// Handle form submission
		seatLayoutForm.addEventListener('submit', (e) => {
			if (seatLayout.length === 0) {
				e.preventDefault();
				alert('Please add at least one row');
				return;
			}

			// Create FormData object for multipart form submission
			const formData = new FormData();
			
			// Add each row as separate form fields
			seatLayout.forEach((row, index) => {
				formData.append(`row[${index}]`, row.name);
				formData.append(`col[${index}]`, row.columns);
				formData.append(`category[${index}]`, row.category);
			});

			e.preventDefault();
			
			fetch('/save-seats', {
				method: 'POST',
				body: formData
			})
			.then(response => response.text())
			.then(data => {
				window.location.href = data;
			})
			.catch(error => {
				console.error('Error:', error);
			});
		});

		// Allow Enter key to add row
		columnsInput.addEventListener('keypress', (e) => {
			if (e.key === 'Enter') {
				addRowBtn.click();
			}
		});

		categorySelect.addEventListener('keypress', (e) => {
			if (e.key === 'Enter') {
				addRowBtn.click();
			}
		});

		rowNameInput.addEventListener('keypress', (e) => {
			if (e.key === 'Enter') {
				addRowBtn.click();
			}
		});
	</script>

</body>
</html>
